<template>
  <div class="home-container">
    <!-- SSRç‰¹æ€§å±•ç¤º -->
    <section>
      <h2>SSR æ ¸å¿ƒç‰¹æ€§</h2>
      <div class="features-grid">
        <div class="feature-card">
          <h3>å¿«é€Ÿé¦–å±åŠ è½½</h3>
          <p>æœåŠ¡å™¨ç›´æ¥è¿”å›å®Œæ•´HTMLï¼Œå‡å°‘å®¢æˆ·ç«¯æ¸²æŸ“æ—¶é—´ï¼Œæå‡ç”¨æˆ·ä½“éªŒ</p>
        </div>
        <div class="feature-card">
          <h3>SEOä¼˜åŒ–</h3>
          <p>æœç´¢å¼•æ“èƒ½ç›´æ¥æŠ“å–å®Œæ•´é¡µé¢å†…å®¹ï¼Œæå‡ç½‘ç«™æ’å</p>
        </div>
        <div class="feature-card">
          <h3>ç»Ÿä¸€å¼€å‘ä½“éªŒ</h3>
          <p>ä½¿ç”¨åŒä¸€å¥—ä»£ç åº“å¼€å‘æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯æ¸²æŸ“</p>
        </div>
        <div class="feature-card">
          <h3>å‡å°‘å®¢æˆ·ç«¯èµ„æºæ¶ˆè€—</h3>
          <p>éƒ¨åˆ†æ¸²æŸ“å·¥ä½œåœ¨æœåŠ¡å™¨å®Œæˆï¼Œé™ä½å®¢æˆ·ç«¯CPUå’Œå†…å­˜å ç”¨</p>
        </div>
        <div class="feature-card">
          <h3>å®æ—¶æ•°æ®è·å–</h3>
          <p>æœåŠ¡å™¨ç«¯å¯ä»¥è·å–æœ€æ–°æ•°æ®ï¼Œç¡®ä¿é¦–å±å±•ç¤ºæœ€æ–°å†…å®¹</p>
        </div>
        <div class="feature-card">
          <h3>è·¨è®¾å¤‡å…¼å®¹æ€§</h3>
          <p>å‡å°‘å®¢æˆ·ç«¯JavaScriptä¾èµ–ï¼Œæé«˜ä½é…ç½®è®¾å¤‡å…¼å®¹æ€§</p>
        </div>
      </div>
    </section>

    <!-- æœåŠ¡å™¨æ•°æ®å±•ç¤º -->
    <section>
      <h2>æœåŠ¡å™¨ç«¯æ•°æ®</h2>
      <div v-if="serverData" class="data-cards-container">
        <div class="data-card">
          <h3>æœåŠ¡å™¨æ—¶é—´</h3>
          <p class="server-time">{{ serverData.time }}</p>
        </div>
        <div class="data-card">
          <h3>Node.jsç‰ˆæœ¬</h3>
          <p>{{ serverData.serverInfo }}</p>
        </div>
        <div class="data-card">
          <h3>å½“å‰ç”¨æˆ·</h3>
          <p>{{ serverData.currentUser }}</p>
        </div>
        <div class="data-card">
          <h3>ä¼šè¯ID</h3>
          <p>{{ serverData.sessionId }}</p>
        </div>
        <div class="data-card">
          <h3>å¤©æ°”ä¿¡æ¯</h3>
          <p>{{ serverData.apiName }}: {{ serverData.temperature }}ï¼Œ{{ serverData.description }}</p>
        </div>
      </div>
      <div v-else class="loading">åŠ è½½ä¸­...</div>
    </section>

    <!-- SSR åŠŸèƒ½æ¼”ç¤ºå…¥å£ -->
    <section>
      <h2>ğŸ¯ SSR åŠŸèƒ½æ¼”ç¤º</h2>
      <div class="demo-links-grid">
        <NuxtLink to="/ssr-demo" class="demo-link-card">
          <div class="demo-icon">ğŸ’§</div>
          <h3>æ°´åˆæ¼”ç¤º</h3>
          <p>äº†è§£æœåŠ¡ç«¯æ¸²æŸ“å¦‚ä½•åœ¨å®¢æˆ·ç«¯"æ¿€æ´»"</p>
        </NuxtLink>
        
        <NuxtLink to="/cache-demo" class="demo-link-card">
          <div class="demo-icon">ğŸ”„</div>
          <h3>ç¼“å­˜ç­–ç•¥</h3>
          <p>æ¢ç´¢ Nuxt çš„æ•°æ®ç¼“å­˜å’Œç®¡ç†æœºåˆ¶</p>
        </NuxtLink>
        
        <NuxtLink to="/performance" class="demo-link-card">
          <div class="demo-icon">âš¡</div>
          <h3>æ€§èƒ½ç›‘æ§</h3>
          <p>æŸ¥çœ‹ SSR çš„æ€§èƒ½æŒ‡æ ‡å’Œä¼˜åŠ¿</p>
        </NuxtLink>
        
        <NuxtLink to="/articles" class="demo-link-card">
          <div class="demo-icon">ğŸ“</div>
          <h3>æ–‡ç« åˆ—è¡¨</h3>
          <p>æŸ¥çœ‹å®Œæ•´çš„æ–‡ç« åˆ—è¡¨å’Œ SEO ä¼˜åŒ–</p>
        </NuxtLink>
      </div>
    </section>
  </div>
</template>

<script setup>
const { useAsyncData, useHead } = await import('#app');

// è®¾ç½®é¡µé¢å…ƒæ•°æ®
useHead({
  title: 'Nuxt 4 SSR Demo - é¦–é¡µ',
  meta: [
    { name: 'description', content: 'è¿™æ˜¯Nuxt 4 SSRæ¼”ç¤ºé¡¹ç›®çš„é¦–é¡µï¼Œå±•ç¤ºäº†æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„æ ¸å¿ƒç‰¹æ€§' }
  ]
});

// æœåŠ¡å™¨ç«¯æ•°æ®è·å–
const { data: serverData } = await useAsyncData('serverData', async () => {
  // æ¨¡æ‹Ÿä»æ•°æ®åº“è·å–æ•°æ®
  const databaseData = {
    currentUser: 'Demo User',
    sessionId: `session_${Math.random().toString(36).substr(2, 9)}`
  };

  // æ¨¡æ‹Ÿè°ƒç”¨å¤–éƒ¨APIï¼ˆè¿™é‡Œä½¿ç”¨é™æ€æ•°æ®æ¨¡æ‹Ÿï¼‰
  const externalApiData = {
    apiName: 'æ¨¡æ‹Ÿå¤©æ°”API',
    temperature: `${Math.round(15 + Math.random() * 10)}Â°C`,
    description: ['æ™´å¤©', 'å¤šäº‘', 'é˜´å¤©', 'å°é›¨'][Math.floor(Math.random() * 4)]
  };

  return {
    time: new Date().toLocaleString('zh-CN'),
    serverInfo: `Node.js ${process.version}`,
    ...databaseData,
    ...externalApiData
  };
});
</script>

<style scoped>
.home-container {
  display: flex;
  flex-direction: column;
  gap: 30px;
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.feature-card {
  background: white;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
}

.feature-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
}

.feature-card h3 {
  margin-top: 0;
  color: #667eea;
}

.data-cards-container {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}

.data-card {
  background: white;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
  min-width: 200px;
}

.data-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
}

.server-time {
  font-size: 1.5rem;
  font-weight: bold;
  color: #667eea;
}

.loading {
  margin-top: 20px;
  color: #667eea;
  font-style: italic;
}

.articles-link {
  background: #f5f5f5;
  padding: 30px;
  border-radius: 10px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  text-align: center;
}

.articles-intro {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
  max-width: 600px;
  margin: 0 auto;
}

.articles-intro p {
  font-size: 1.1rem;
  color: #333;
  line-height: 1.6;
  margin: 0;
}

.articles-button {
  display: inline-block;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 12px 24px;
  border-radius: 25px;
  text-decoration: none;
  font-weight: bold;
  font-size: 1.1rem;
  transition: all 0.3s ease;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}

.articles-button:hover {
  transform: translateY(-3px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
  text-decoration: none;
  color: white;
}

.demo-links-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.demo-link-card {
  background: white;
  padding: 25px;
  border-radius: 10px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  text-decoration: none;
  color: inherit;
  transition: all 0.3s ease;
  text-align: center;
}

.demo-link-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
}

.demo-icon {
  font-size: 3rem;
  margin-bottom: 15px;
}

.demo-link-card h3 {
  margin: 0 0 10px 0;
  color: #667eea;
  font-size: 1.3rem;
}

.demo-link-card p {
  margin: 0;
  color: #666;
  font-size: 0.95rem;
  line-height: 1.5;
}
</style>